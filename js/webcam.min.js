function detectWebcams(){$("select[name='cameras'] option").remove();try{navigator.mediaDevices.enumerateDevices().then(e=>{e.forEach(e=>{"videoinput"==e.kind?$("select[name='cameras']").append('<option value="'+e.deviceId+'">'+e.label+"</option>"):console.log("Detected device "+e.deviceId+"\nIt is not videoinput: "+e.kind)}),$("select[name='cameras'] option").length||$.spawnAlert({title:"Error",body:"No webcams detected",color:"warning"})}).catch(e=>{$.spawnAlert({title:"Error",body:e,color:"danger"})})}catch(e){alert(e)}}function previewWebcam(){if($("select[name='cameras'] option").length){stopPreview();var e={audio:!1,video:{video:{width:{min:320,max:1920},height:{min:240,max:1080},frameRate:{ideal:30,min:10}},deviceId:{exact:$("select[name='cameras']").val()}}};navigator.mediaDevices.getUserMedia(e).then(e=>{var t=$("#videoPreview").get(0);t.srcObject=e,t.play()}).catch(function(e){$.spawnAlert({title:"Error",body:e,color:"danger"})})}else $.spawnAlert({title:"Error",body:"No webcams detected",color:"warning"})}function stopPreview(){var e=$("#videoPreview").get(0);null!=e.srcObject?(e.srcObject.getTracks().forEach(e=>{e.stop()}),e.pause(),e.srcObject=null):$.spawnAlert({title:"Error",body:"No video playback is active",color:"warning"})}function takePicture(){var e=$("#videoPreview");if(null!=e.srcObject){var t=document.createElement("canvas");t.width=e.width(),t.height=e.height();var a=t.getContext("2d");a.drawImage(e.get(0),0,0,t.width,t.height);var o=document.createElement("a");o.download=$.randomUUID()+".jpg",o.href=t.toDataURL("image/jpg"),o.dataset.downloadurl=["image/jpg",o.download,o.href].join(":"),document.body.appendChild(o),o.click(),document.body.removeChild(o)}else $.spawnAlert({title:"Error",body:"No active video playback to take picture",color:"warning"})}